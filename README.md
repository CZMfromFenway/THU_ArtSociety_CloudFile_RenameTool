# THU美社云盘文件命名工具应用程序

## 概述
本库包含THU美社2025-2026届队委会信息化运动中的云盘格式规范化项目所需的云盘文件命名工具程序的源代码。

## 使用说明

### 基础

打开可执行文件，在Preset一栏中选择命名预设，在Folder一栏中填入目标文件夹路径，点击Rename按钮即可一键命名该目录下符合条件的所有文件。

目前，预设有“custom”（自定义）“activity”（活动照片和视频）和“artwork”（作品命名）三种。

最下方一栏会显示命名操作的输出情况（或报错信息）。

### 进阶

有特殊命名需要时可自定义程序中的参数，实现更自由的批量命名。

#### 参数
- Format，命名格式，分为正则表达式模式和其他模式
- Content，命名内容，在正则表达式模式下为替换内容，其他模式下经过程序提取后成为固定占位符
- File type，目标文件夹类型（根据扩展名筛选）

#### 正则表达式模式
- 当Format栏以半角问号“?”开头时，表示该栏内容（问号后的内容）为正则表达式，程序会按正则表达式匹配文件名，匹配成功的文件会被重命名为Content栏中指定的内容。正则表达式中可以使用捕获组，并在Content栏中用“\n”（n为捕获组编号）引用捕获组。

**例**
- Format栏为“?张三”，Content栏为“李四”，所有含有“张三”的文件名都会被重命名为将“张三”替换为“李四”后的名称。
- Format栏为“?^(.*)_(.*)_(.*)$”，Content栏为“\3_\2_\1”，则名为“1001_张三_001”的文件会被重命名为“001_张三_1001”。

*（以下内容均就其他模式进行介绍）*

#### 命名格式解析
- “\x”为固定占位符，x为阿拉伯数字，为其编号。固定占位符会被原封不动地替换成固定占位符中的元素，编号对应这固定占位符元素中的位置。
- “\dn”为编号占位符，n为编号的长度。编号占位符会被按文件顺序替换成编号，长度不足则补零。如“$d3”代表000、001、002……

**例**
- 格式\1_\2_\d3，占位符为“0929”和“张三”，那么对应的文件名就是“0929_张三_xxx”，其中“xxx”是编号，从0开始给本批次命名的文件依次编号。

#### 固定占位符提取
- Content栏中填入的内容在重命名时会被按半角逗号分割，分割的每部分会截取半角冒号后前后去除空格的部分作为一个固定占位符。
- 若固定占位符的数量和命名格式中的不匹配，命名操作会失败。

**例**
- Content为“Date: 0929, Name: 张三”，则提取的固定占位符依次为“0929”和“张三”。

#### 命名模式解析
在格式字符串前后可以出现零或一个星号。
- 前置星号意味着命名模式为后缀添加。当检测到文件的后缀已*符合格式*时，不会再修改这个文件的名称；否则，在文件原名上加一个下划线，后跟命名格式指定的内容。后置星号意味着前缀添加，效果同理。
- 无星号意味着正常添加，在改名后，用户可以在已修改的文件名前后添加内容，下次命名时不会认为这样的文件名不*符合格式*。前后都有星号意味着严格改名，即改名后用户若在已修改的文件名前后添加内容，这样的文件名都会在下次改名时被认为不*符合格式*，用户的修改将被覆盖。

**例**
- 对于格式 **\1_\2_\d3**，若占位符为“0929”和“张三”，那么名为“1001_李四_001”的文件和名为“1001_李四_001_备注”的文件就不会被重新命名；若格式为 **\*$1_$2_$d3\***，那么名为“1001_李四_001”的文件不会被重命名，但是名为“1001_李四_001_备注”的文件就会被重命名为“0929_张三_xxx”。
- 对于格式 **\*\1_\2_\d3**，若占位符为“0929”和“张三”，名为“abcd”的文件会被命名为“abcd_0929_张三_xxx”，名为“abcd_1001_李四_001”的文件不会被重命名，但是名为“1001_李四_001_备注”的文件会被重命名为“1001_李四_001_备注_0929_张三_xxx”。

#### 命名对象筛选
- 若某文件的目标名称在相同目录下已存在，则不会更改。
- 若某文件扩展名不符合筛选条件，则不会更改。
- 若某文件文件名已*符合格式*，则不会更改。*符合格式*判定要求文件名（的前缀或后缀，或整个）符合命名格式产生的内容，但是相应固定占位符的内容可以不一样。在编号时，若格式相同而固定占位符不同的文件会分别独立编号。

**例**
- 对于格式 **\1_\2_\d3**，若占位符为“0929”和“张三”，且文件夹中已经有名为“0929_张三_025”的文件，那么新一批被命名的文件就会从26开始编号；若文件夹中只有名为“1001_李四_010”的文件，那么该文件不会被重命名，且新一批被命名的文件会从0开始编号。
- 对于格式 **\*\1_\2_\d3**，若占位符为“0929”和“张三”，名为“abcd”的文件不*符合格式*，名为“abcd_1001_李四_001”的文件*符合格式*，但是名为“1001_李四_001_备注”的文件不*符合格式*。

#### 命名文件类型

- 目前，程序提供了三种文件类型预设，分别为“Picture”“Video”和“Document”，对应图像、视频和文档。
- 若此三种预设没有完全涵盖目标文件的扩展名，可在下方栏中填写；若下方栏为空，则仅根据已勾选的预设进行匹配；若下方栏为空且未勾选任何预设，默认重命名所有类型的文件。
- 下方栏的填写方式遵循正则表达式的规则，以“或”的关系与已选预设结合。

程紫陌
20251007